%h1 
  Courses
%span.big
  = @courses.to_a.size
  - if params[:search]
    courses found for
    %em= params[:search]
  - elsif params[:category]
    courses in
    %em= params[:category]
  - elsif params[:all]
    visible courses
  - else
    featured courses
    %br
    %br
    %p= link_to "View All Courses", courses_path(all: true)
.break
- if @courses.empty?
  %h3
    %em Sorry! No courses to show...
- else
  .courses
    - @courses.each do |c|
      .course-row
        %span.big
          = link_to c.title.humanize, c
        %span.pull-right
          = link_to c.teacher.username, c.teacher
          - if c.teacher.avatar_url
            = avatar_tag c.teacher, height: 25, class: 'avatar-small'
          - if enrolled? c
            - p = c.percent_complete(current_user)
            = "#{p}%"
        %br
        %span.small= c.category
        %br
        %br
        .description
          = c.description.html_safe
        %span.small
          == #{c.sections.count} sections,
          == #{c.subsections.count} subsections,
          == #{c.questions.count} questions
        - if taught? c
          .btn-toolbar
            .btn-group
              = link_to icon(:pencil), edit_course_path(c)
              = link_to icon(:remove), c, method: :delete, data: { confirm: 'Are you sure?' }

- if logged_in?
  .break
  .btn-group
    - create_link = "Create a Course"
    - create_link << " about #{params[:search].titleize}" if params[:search]
    = link_to create_link + "!", new_course_path, class: 'btn btn-success'

- content_for :sidebar do
  %li.nav-header Categories
  - Course.categories(logged_in?).each do |c|
    %li= link_to "#{c['category']} (#{c['count']})", courses_path(category: c['category']), class: "#{c['category'] == params['category'] ? 'light-purple' : 'white'}"
  %li= link_to "Create a Course", new_course_path, class: 'light-purple'